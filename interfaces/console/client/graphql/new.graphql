# NODE GRAPH

fragment node on Node {
  id
  name
  orgId
  type
  attached {
    id
    name
    orgId
    type
    site {
      nodeId
      siteId
      networkId
      addedAt
    }
    status {
      connectivity
      state
    }
  }
  site {
    nodeId
    siteId
    networkId
    addedAt
  }
  status {
    connectivity
    state
  }
}

query getNode($data: NodeInput!) {
  getNode(data: $data) {
    ...node
  }
}

query getNodes($data: GetNodesInput!) {
  getNodes(data: $data) {
    nodes {
      ...node
    }
  }
}

query getNodesByNetwork($networkId: String!) {
  getNodesByNetwork(networkId: $networkId) {
    nodes {
      ...node
    }
  }
}

mutation deleteNode($data: NodeInput!) {
  deleteNodeFromOrg(data: $data) {
    id
  }
}

mutation attachNode($data: AttachNodeInput!) {
  attachNode(data: $data) {
    success
  }
}

mutation detachhNode($data: NodeInput!) {
  detachhNode(data: $data) {
    success
  }
}

mutation addNode($data: AddNodeInput!) {
  addNode(data: $data) {
    ...node
  }
}

mutation releaseNodeFromSite($data: NodeInput!) {
  releaseNodeFromSite(data: $data) {
    success
  }
}

mutation addNodeToSite($data: AddNodeToSiteInput!) {
  addNodeToSite(data: $data) {
    success
  }
}

mutation updateNodeState($data: UpdateNodeStateInput!) {
  updateNodeState(data: $data) {
    ...node
  }
}

mutation UpdateNode($data: UpdateNodeInput!) {
  updateNode(data: $data) {
    ...node
  }
}
### End Node ###

### Member Start ###

fragment member on MemberDto {
  role
  orgId
  userId
  isDeactivated
  memberSince
}

query GetMembers {
  getMembers {
    members {
      ...member
    }
  }
}

query GetMember($memberId: String!) {
  getMember(id: $memberId) {
    ...member
  }
}

mutation addMember($data: AddMemberInputDto!) {
  addMember(data: $data) {
    ...member
  }
}

mutation removeMember($memberId: String!) {
  removeMember(id: $memberId) {
    success
  }
}

mutation updateMember($memberId: String!, $data: UpdateMemberInputDto!) {
  updateMember(memberId: $memberId, data: $data) {
    success
  }
}

### End Member ###

### Org Start ###

fragment Org on OrgDto {
  id
  name
  owner
  certificate
  isDeactivated
  createdAt
}

query getOrgs {
  getOrgs {
    user
    ownerOf {
      ...Org
    }
    memberOf {
      ...Org
    }
  }
}

query getOrg {
  getOrg {
    ...Org
  }
}
### Org End ###

### Package Start ###
fragment PackageRate on PackageDto {
  rate {
    sms_mo
    sms_mt
    data
    amount
  }
}
fragment PackageMarkup on PackageDto {
  markup {
    baserate
    markup
  }
}
fragment Package on PackageDto {
  uuid
  name
  orgId
  active
  duration
  simType
  createdAt
  deletedAt
  updatedAt
  smsVolume
  dataVolume
  voiceVolume
  ulbr
  dlbr
  type
  dataUnit
  voiceUnit
  messageUnit
  flatrate
  currency
  from
  to
  country
  provider
  apn
  ownerId
  amount
  ...PackageRate
  ...PackageMarkup
}
query getPackages {
  getPackages {
    packages {
      ...Package
    }
  }
}
query getPackage($packageId: String!) {
  getPackage(packageId: $packageId) {
    ...Package
  }
}

query getPackages {
  getPackages {
    packages {
      ...Package
    }
  }
}

mutation addPackage($data: AddPackageInputDto!) {
  addPackage(data: $data) {
    ...Package
  }
}

mutation deletePacakge($packageId: String!) {
  deletePackage(packageId: $packageId) {
    uuid
  }
}

mutation updatePacakge($packageId: String!, $data: UpdatePackageInputDto!) {
  updatePackage(packageId: $packageId, data: $data) {
    ...Package
  }
}

### Package End ###

### SimPool Start ###
query getSimpoolStats($type: String!) {
  getSimPoolStats(type: $type) {
    total
    available
    consumed
    failed
    physical
    esim
  }
}
mutation uploadSims($data: UploadSimsInputDto!) {
  uploadSims(data: $data) {
    iccid
  }
}

fragment SimPool on SimDto {
  activationCode
  createdAt
  iccid
  id
  isAllocated
  isPhysical
  msisdn
  qrCode
  simType
  smapAddress
}

query getSims($type: String!) {
  getSims(type: $type) {
    sim {
      ...SimPool
    }
  }
}

### SimPool End ###

### Subscriber Start ###

fragment SubscriberSim on SubscriberDto {
  sim {
    id
    subscriberId
    networkId
    orgId
    iccid
    msisdn
    imsi
    type
    status
    firstActivatedOn
    lastActivatedOn
    activationsCount
    deactivationsCount
    allocatedAt
    isPhysical
    package
  }
}

fragment Subscriber on SubscriberDto {
  uuid
  address
  dob
  email
  firstName
  lastName
  gender
  idSerial
  networkId
  orgId
  phone
  proofOfIdentification
  ...SubscriberSim
}

mutation addSubscriber($data: SubscriberInputDto!) {
  addSubscriber(data: $data) {
    ...Subscriber
  }
}

query getSubscriber($subscriberId: String!) {
  getSubscriber(subscriberId: $subscriberId) {
    ...Subscriber
  }
}

mutation updateSubscriber(
  $subscriberId: String!
  $data: UpdateSubscriberInputDto!
) {
  updateSubscriber(subscriberId: $subscriberId, data: $data) {
    success
  }
}

mutation deleteSubscriber($subscriberId: String!) {
  deleteSubscriber(subscriberId: $subscriberId) {
    success
  }
}

query getSubscribersByNetwork($networkId: String!) {
  getSubscribersByNetwork(networkId: $networkId) {
    subscribers {
      ...Subscriber
    }
  }
}

query getSubscriberMetricsByNetwork($networkId: String!) {
  getSubscriberMetricsByNetwork(networkId: $networkId) {
    total
    active
    inactive
    terminated
  }
}

### Subscriber End ###

### User Start ###

fragment User on UserResDto {
  name
  uuid
  email
  phone
  authId
  isDeactivated
  registeredSince
}

query Whoami {
  whoami {
    user {
      ...User
    }
    ownerOf {
      ...Org
    }
    memberOf {
      ...Org
    }
  }
}

query GetUser($userId: String!) {
  getUser(userId: $userId) {
    ...User
  }
}

### User End ###

### Networks Start ###

query getNetworks {
  getNetworks {
    orgId
    networks {
      id
      name
      orgId
      isDeactivated
      createdAt
    }
  }
}

query getSites($networkId: String!) {
  getSites(networkId: $networkId) {
    networkId
    sites {
      id
      name
      networkId
      isDeactivated
      createdAt
    }
  }
}

### Networks End ###

# PLANNING TOOL GRAPH
fragment location on Location {
  id
  lat
  lng
  address
}
fragment link on Link {
  id
  siteA
  siteB
}
fragment site on Site {
  id
  url
  east
  name
  west
  north
  south
  status
  height
  apOption
  isSetlite
  solarUptime
  populationUrl
  populationCovered
  totalBoxesCovered
  location {
    ...location
  }
}
fragment event on Event {
  id
  value
  operation
  createdAt
}
fragment draft on Draft {
  id
  name
  userId
  lastSaved
  links {
    ...link
  }
  sites {
    ...site
  }
  events {
    ...event
  }
}

mutation AddDraft($data: AddDraftInput!) {
  addDraft(data: $data) {
    ...draft
  }
}

mutation UpdateDraftName($draftId: String!, $name: String!) {
  updateDraftName(id: $draftId, name: $name) {
    ...draft
  }
}

query GetDrafts($userId: String!) {
  getDrafts(userId: $userId) {
    ...draft
  }
}

query GetDraft($draftId: String!) {
  getDraft(id: $draftId) {
    ...draft
  }
}

mutation addSite($draftId: String!, $data: SiteInput!) {
  addSite(draftId: $draftId, data: $data) {
    ...draft
  }
}

mutation UpdateSite($draftId: String!, $siteId: String!, $data: SiteInput!) {
  updateSite(draftId: $draftId, siteId: $siteId, data: $data) {
    ...draft
  }
}

mutation UpdateLocation(
  $draftId: String!
  $locationId: String!
  $data: LocationInput!
) {
  updateLocation(draftId: $draftId, locationId: $locationId, data: $data) {
    ...location
  }
}

mutation DeleteDraft($draftId: String!) {
  deleteDraft(id: $draftId) {
    id
  }
}

mutation DeleteSite($siteId: String!) {
  deleteSite(id: $siteId) {
    id
  }
}

mutation DeleteLink($lastSaved: Float!, $draftId: String!, $linkId: String!) {
  deleteLink(lastSaved: $lastSaved, draftId: $draftId, linkId: $linkId) {
    id
  }
}

mutation AddLink($data: LinkInput!, $draftId: String!) {
  addLink(data: $data, draftId: $draftId) {
    ...draft
  }
}

mutation Coverage($siteId: String!, $data: CoverageInput!) {
  coverage(data: $data, siteId: $siteId) {
    ...site
  }
}
