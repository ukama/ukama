syntax = "proto3";

option go_package = "github.com/ukama/ukama/systems/node/state/pb/gen";

package ukama.node.state.v1;

import "validator.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

service StateService {
    rpc Create(CreateStateRequest) returns (CreateStateResponse);
    rpc GetByNodeId(GetByNodeIdRequest) returns (GetByNodeIdResponse);
    rpc Delete(DeleteStateRequest) returns (DeleteStateResponse);
    rpc GetStateHistory(GetStateHistoryRequest) returns (GetStateHistoryResponse);
}

message DeleteStateResponse{

}

message CreateStateResponse{
    State state =1;
}
message GetByNodeIdResponse {
    State state =1;

}
message State {
    string id = 1;
    string nodeId = 2 [(validator.field) = {string_not_empty: true}, json_name = "node_id"];
    NodeStateEnum State = 3;
    google.protobuf.Timestamp lastHeartbeat = 5;
    string type = 6;
    string version = 7;
    google.protobuf.Timestamp LastStateChange = 9;
}

enum NodeStateEnum {
    STATE_UNKOWN = 0;
    STATE_CONFIGURE = 2;
    STATE_OPERATIONAL = 3;
    STATE_FAULTY = 5;
}


message CreateStateRequest {
    State state = 1;
}

message GetByNodeIdRequest {
    string nodeId = 1 [(validator.field) = {string_not_empty: true}, json_name = "node_id"];

}


message DeleteStateRequest {
    string nodeId = 1 [(validator.field) = {string_not_empty: true}, json_name = "node_id"];

}

message ListAllResponse {
    repeated State states = 1;
}

message GetStateHistoryRequest {
    string nodeId = 1[(validator.field) = {string_not_empty: true}, json_name = "node_id"];
}

message GetStateHistoryResponse {
    repeated State stateHistory = 1;
}