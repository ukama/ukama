{
    "version": 2,
    "extra_config": {
      "github_com/devopsfaith/krakend-gologging": {
        "level": "ERROR",
        "prefix": "[KRAKEND]",
        "syslog": false,
        "stdout": true,
        "format": "default"
      },
      "github_com/devopsfaith/krakend-metrics": {
        "collection_time": "60s",
        "proxy_disabled": false,
        "router_disabled": false,
        "backend_disabled": false,
        "endpoint_disabled": false,
        "listen_address": ":8090"
      }
    },
    "timeout": "3000ms",
    "cache_ttl": "300s",
    "output_encoding": "json",
    "name": "BootstapAPI",    
    "endpoints": [
   

      {{ range $idx, $endpoint := .endpoint.lookup_group }}
      {{if $idx}},{{end}}
      {
      "endpoint": "{{ $endpoint.endpoint }}",
      "method": "{{ $endpoint.method }}",
      "output_encoding": "no-op",
      "extra_config":  {
        {{if not $endpoint.no_auth }}
        "github.com/devopsfaith/krakend-jose/validator": {
          "alg": {{ env "AUTH_ALG" | quote }},
          "audience": [ {{ env "AUTH_AUDIENCE" | quote }} ],
          "jwk-url":  {{ env "AUTH_JWK_URL" | quote }}
          }
        {{end}} 
      },
      "backend": [
          {
              "url_pattern": "{{ $endpoint.backend }}",
              "encoding": "no-op",
              "method": "{{ $endpoint.method }}",
              "host": {{ marshal  $.endpoint.lookup_host  }} ,
              "disable_host_sanitize": false
          }
      ]
      }
      {{ end }}

    ]
  }

